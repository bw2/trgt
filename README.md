
## TRGT fork

This fork takes the [official version of TRGT](https://github.com/pacificBiosciences/trgt) and modifies the **plot** subcommand to:
* Show mismatched bases
* Use easier-to-read fonts and colors similar to the ones in IGV
* Change the repeat width label above the plot to repeat counts instead of base pairs
* Add vertical gridlines and labels across the repeat interval showing 5x, 10x, .. repeats
* Label each insertion with the number of bases inserted  (eg. the vertical line "|" now appears as "|3" if 3bp were inserted)
* Increase the default image width

<br />

### Example 1:

#### Allele Plot:

<img width="1568" height="478" alt="image" src="https://github.com/user-attachments/assets/88f51150-5abe-454d-a8cc-e835ddd533b0" />

#### Waterfall Plot:

<img width="1576" height="407" alt="image" src="https://github.com/user-attachments/assets/aea9e3fa-7979-4447-9617-529cffd80b40" />


#### Allele Plot with Methylation:

<img width="1575" height="469" alt="image" src="https://github.com/user-attachments/assets/fbfc4374-2c20-4f7a-be95-b92a9a3887b0" />

#### Waterfall Plot with Methylation:

<img width="1581" height="411" alt="image" src="https://github.com/user-attachments/assets/1a8bbe14-51cd-4a40-b8db-881102bcbad8" />


#### Deep Dive:

Included here for comparison. Deep dive functionality is unchanged.

<img width="1571" height="294" alt="image" src="https://github.com/user-attachments/assets/b2102081-a9c6-4a6c-88b4-5997d3381d99" />


### Example 2:

Pathogenic expansion at the DM2 / CNBP locus. The long allele contains runs of perfect CAGG repeats interrupted by short intervals with non-CAGG sequences (HMM unsegmented regions). 

#### Allele Plot:

<img width="2524" height="1244" alt="image" src="https://github.com/user-attachments/assets/078fc211-267a-4ad2-bdd2-0dc4b7302f5b" />

#### Waterfall Plot:

<img width="2524" height="1095" alt="image" src="https://github.com/user-attachments/assets/c88c4a0e-0e8a-443a-bcfa-5cb59379d5d2" />


<h1 align="center">TRGT</h1>

<h3 align="center">Tandem repeat genotyping tool for HiFi sequencing data</h3>

TRGT is a tool for targeted genotyping of tandem repeats from PacBio HiFi data.
In addition to the basic size genotyping, TRGT profiles sequence composition,
mosaicism, and CpG methylation of each analyzed repeat and visualization of
reads overlapping the repeats.

## Version information

Current version: **5.0.0**.

For a complete changelog, see the [changelog](CHANGELOG.md) or the git history.

## Active development warning

Please note that TRGT is still under active development. We anticipate some
changes to the input and output file formats of TRGT.

## Availability

- TRGT Linux binary is [available here](https://github.com/PacificBiosciences/trgt/releases)

## Repeat catalogs

In order to use TRGT, you need to specify which repeats you want it to analyze.
Here are some repeat catalogs that you can use.

- [STRchive](https://strchive.org/loci/) is a high-quality catalog containing
  definitions of known pathogenic repeats. It is described [here](https://genomemedicine.biomedcentral.com/articles/10.1186/s13073-025-01454-4).
- ["Adotto" genome-wide repeat catalog](<https://zenodo.org/records/8329210>) described in the original TRGT paper and [here](https://pubmed.ncbi.nlm.nih.gov/38671154/).
- [Genome-wide repeat catalog containing isolated tandem repeats and variation clusters](https://github.com/broadinstitute/tandem-repeat-catalog/releases) described [here](https://www.biorxiv.org/content/10.1101/2024.10.04.615514v1).
- [Catalog of pathogenic repeats](repeats/pathogenic_repeats.hg38.bed) originally distributed with TRGT has been deprecated; please use STRchive.

## Joint analysis of multiple samples

TRGT outputs VCFs containing repeat alleles from each region in the repeat
catalog. To facilitate analysis of repeats across multiple samples, VCFs can be
either merged into a multi-sample VCF using the `merge` sub-command or converted
into a database using the [TDB tool](https://github.com/ACEnglish/tdb) (formerly
called TRGTdb). TDB offers many advantages over multi-sample VCFs, including
simpler data extraction, support for queries, and reduced file sizes.

## Documentation

- Tutorials
  - Introductory tutorial: [non-interactive](docs/tutorial.md) and
    [interactive](https://mybinder.org/v2/gh/tandem-repeat-workflows/trgt-tutorial/HEAD?labpath=tutorial.ipynb)
    versions
  - [Interpreting TRGT plots](docs/trvz-plots.md)
  - [Analyzing PureTarget data](docs/puretarget.md)
- Reference
  - [Command-line interface](docs/cli.md)
  - [Repeat definition file](docs/repeat_files.md)
  - [Spanning BAM generated by TRGT](docs/bam_files.md)
  - [VCF files generated by TRGT](docs/vcf_files.md)
  - [Remote file support](docs/remote_files.md)
  - [Merging TRGT VCFs](docs/merge.md)
  - [Deepdive subcommand](docs/deepdive.md)
  - [Validating repeat catalogs](docs/validate.md)

## Need help?

If you notice any missing features, bugs, or need assistance with analyzing the
output of TRGT, please don't hesitate to [reach out by email](mailto:edolzhenko@pacificbiosciences.com)
or open a GitHub issue.

## Support information

TRGT is currently in active development and is intended for research use only and not for use
in diagnostic procedures. While efforts have been made to ensure that TRGT
lives up to the quality that PacBio strives for, we make no warranty regarding
this software.

As TRGT is not covered by any service level agreement or the like, please do
not contact a PacBio Field Applications Scientists or PacBio Customer Service
for assistance with any TRGT release. Please report all issues through GitHub
instead. We make no warranty that any such issue will be addressed, to any
extent or within any time frame.

## Citation

If you use TRGT, please consider citing the paper:

[Dolzhenko E, English A, Dashnow H, De Sena Brandine G, Mokveld T, Rowell WJ,
Karniski C, Kronenberg Z, Danzi MC, Cheung W, Bi C, Farrow E, Wenger A,
Martínez-Cerdeño V, Bartley TD, Jin P, Nelson D, Zuchner S, Pastinen T,
Quinlan AR, Sedlazeck FJ, Eberle MA. Characterization and visualization of
tandem repeats at genome scale. 2024](https://www.nature.com/articles/s41587-023-02057-3)

### DISCLAIMER

THIS WEBSITE AND CONTENT AND ALL SITE-RELATED SERVICES, INCLUDING ANY DATA, ARE
PROVIDED "AS IS," WITH ALL FAULTS, WITH NO REPRESENTATIONS OR WARRANTIES OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, ANY WARRANTIES
OF MERCHANTABILITY, SATISFACTORY QUALITY, NON-INFRINGEMENT OR FITNESS FOR A
PARTICULAR PURPOSE. YOU ASSUME TOTAL RESPONSIBILITY AND RISK FOR YOUR USE OF THIS
SITE, ALL SITE-RELATED SERVICES, AND ANY THIRD PARTY WEBSITES OR APPLICATIONS. NO
ORAL OR WRITTEN INFORMATION OR ADVICE SHALL CREATE A WARRANTY OF ANY KIND. ANY
REFERENCES TO SPECIFIC PRODUCTS OR SERVICES ON THE WEBSITES DO NOT CONSTITUTE OR
IMPLY A RECOMMENDATION OR ENDORSEMENT BY PACIFIC BIOSCIENCES.
