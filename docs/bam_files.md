# TRGT spanning BAM files

The spanning BAM generated by TRGT contains only the reads that were used for
genotyping each of the targeted loci. Each read is trimmed to the repeat along
with flanking sequence (50 bp by default, configurable using
`--output-flank-len` in `trgt genotype`). These BAM files are intended for
inspection (for example, in IGV) and for downstream analyses such as `trgt plot`
or `trgt deepdive`.

**Note**: As TRGT is under active development, the BAM formatting may be subject
to changes in future versions.

## BAM tags

Each BAM record follows the standard SAM layout (QNAME, FLAG, RNAME, POS,
MAPQ, CIGAR, SEQ, QUAL). See the [SAM specification](https://samtools.github.io/hts-specs/)
for more details. TRGT extends these records with the following tags:

- `TR:Z` — Unique locus identifier from the catalog
- `AL:i` — Allele assignment, TRGT labels alleles `0` and `1` in genotype
order: when two distinct alternate alleles are present, `0` is the shorter and `1` is the longer; whenever the reference allele is present, `0` designates the reference regardless of length, and in homozygous-reference calls both `0` and `1` correspond to the reference allele; haploid loci may only have `0`
- `SO:i` — Start offset of the read relative to the locus start (negative = upstream)
- `EO:i` — End offset of the read relative to the locus end (positive = downstream)
- `MO:B:i` — Offsets of mismatches in the flanking regions outside the repeat
- `FL:B:I` — Left/right flank lengths included with the repeat (typically `50,50`)
- `MC:B:C` — Per-base methylation encoding
- `rq:f` — Predicted read accuracy ([PacBio `rq` tag](https://pacbiofileformats.readthedocs.io/en/11.0/BAM.html#use-of-read-tags-for-per-read-information))